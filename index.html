<script>
const apiURL = "https://script.google.com/macros/s/AKfycbwV4MHx9sC86b2FHQT88YTANoQe4bicExqRJUz9uQBf4V_6yRBQbKAlURHpp1JHDZk_/exec";

function onScanSuccess(decodedText) {

    const data = {
        nama: decodedText,
        kelas: "VI A",
        kode: decodedText
    };

    fetch(apiURL, {
        method: "POST",
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(result => {
        alert("Absensi Berhasil ✅");
    })
    .catch(error => {
        alert("Gagal kirim data ❌");
    });
}

const html5QrCode = new Html5Qrcode("reader");

Html5Qrcode.getCameras().then(devices => {
    if (devices && devices.length) {
        html5QrCode.start(
            devices[0].id,
            {
                fps: 10,
                qrbox: 250
            },
            onScanSuccess
        );
    }
}).catch(err => {
    alert("Gagal akses kamera: " + err);
});
</script>
